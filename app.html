<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#4A90E2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Image Composer</title>
    <link rel="manifest" href="/manifest.json">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
        }
        body {
            overscroll-behavior: none;
        }
        .crop-area {
            position: absolute;
            border: 2px solid #4A90E2;
            background: rgba(74, 144, 226, 0.1);
            cursor: move;
        }
        .resize-handle {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #4A90E2;
            border: 2px solid white;
            border-radius: 50%;
        }
        .handle-nw { top: -10px; left: -10px; cursor: nwse-resize; }
        .handle-ne { top: -10px; right: -10px; cursor: nesw-resize; }
        .handle-sw { bottom: -10px; left: -10px; cursor: nesw-resize; }
        .handle-se { bottom: -10px; right: -10px; cursor: nwse-resize; }
        .image-card {
            transition: transform 0.1s;
        }
        .image-card:active {
            transform: scale(0.95);
        }
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            z-index: 1000;
            animation: slideUp 0.3s ease;
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translate(-50%, 20px); }
            to { opacity: 1; transform: translate(-50%, 0); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Ïï± Ïª®ÌÖåÏù¥ÎÑà -->
    <div id="app" class="max-w-2xl mx-auto bg-white min-h-screen shadow-lg">
        <!-- Ìó§Îçî -->
        <header class="bg-blue-500 text-white p-4 sticky top-0 z-50 shadow">
            <h1 class="text-xl font-bold">‚úÇÔ∏è Image Composer</h1>
            <p class="text-sm opacity-90">Ïù¥ÎØ∏ÏßÄ ÌÅ¨Î°≠ & Ìï©ÏÑ±</p>
        </header>

        <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
        <main class="pb-20">
            <!-- ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
            <nav class="flex border-b sticky top-16 bg-white z-40">
                <button onclick="switchTab('input')" id="tab-input" class="flex-1 py-3 font-medium border-b-2 border-blue-500 text-blue-500">
                    Ïù¥ÎØ∏ÏßÄ
                </button>
                <button onclick="switchTab('edit')" id="tab-edit" class="flex-1 py-3 font-medium border-b-2 border-transparent text-gray-500">
                    Ìé∏Ïßë
                </button>
                <button onclick="switchTab('compose')" id="tab-compose" class="flex-1 py-3 font-medium border-b-2 border-transparent text-gray-500">
                    Ìï©ÏÑ±
                </button>
            </nav>

            <!-- Ïù¥ÎØ∏ÏßÄ ÏûÖÎ†• ÌÉ≠ -->
            <div id="content-input" class="p-4">
                <!-- ÌååÏùº ÏÑ†ÌÉù -->
                <label class="block w-full p-8 border-2 border-dashed border-gray-300 rounded-lg text-center cursor-pointer hover:border-blue-400 active:bg-gray-50">
                    <input type="file" id="fileInput" accept="image/*" multiple class="hidden">
                    <div class="text-4xl mb-2">üìÅ</div>
                    <div class="text-lg font-medium">Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉù</div>
                    <div class="text-sm text-gray-500 mt-1">Ïó¨Îü¨ Ïû• ÏÑ†ÌÉù Í∞ÄÎä•</div>
                </label>

                <!-- Ïù¥ÎØ∏ÏßÄ Í∞§Îü¨Î¶¨ -->
                <div id="imageGallery" class="mt-4 grid grid-cols-2 gap-3"></div>
            </div>

            <!-- Ìé∏Ïßë ÌÉ≠ -->
            <div id="content-edit" class="p-4 hidden">
                <!-- ÌîÑÎ¶¨ÏÖã -->
                <div class="mb-6">
                    <h3 class="font-bold mb-3">ÌÅ¨Î°≠ ÌîÑÎ¶¨ÏÖã</h3>
                    <div class="grid grid-cols-2 gap-3" id="presetButtons"></div>
                </div>

                <!-- ÏÑ†ÌÉùÎêú Ïù¥ÎØ∏ÏßÄ Ï†ïÎ≥¥ -->
                <div id="selectedInfo" class="mb-4 p-3 bg-blue-50 rounded-lg hidden">
                    <div class="text-sm font-medium text-blue-700">ÏÑ†ÌÉù: <span id="selectedCount">0</span>Í∞ú</div>
                </div>

                <!-- ÌÅ¨Î°≠ Ìé∏ÏßëÍ∏∞ -->
                <div id="cropEditor" class="hidden">
                    <h3 class="font-bold mb-3">ÌÅ¨Î°≠ ÏòÅÏó≠ Ï°∞Ï†ï</h3>
                    <div class="relative inline-block w-full">
                        <img id="cropImage" class="max-w-full rounded">
                        <div id="cropOverlay" class="absolute top-0 left-0 w-full h-full pointer-events-none"></div>
                    </div>
                    <div class="mt-4 space-y-2">
                        <input type="text" id="commentInput" placeholder="ÏΩîÎ©òÌä∏ Ï∂îÍ∞Ä (ÏÑ†ÌÉùÏÇ¨Ìï≠)" 
                               class="w-full p-3 border rounded-lg">
                        <button onclick="applyCrop()" class="w-full py-3 bg-blue-500 text-white rounded-lg font-medium active:bg-blue-600">
                            ‚úì ÌÅ¨Î°≠ Ï†ÅÏö©
                        </button>
                        <button onclick="cancelCrop()" class="w-full py-2 text-gray-600 border rounded-lg active:bg-gray-50">
                            Ï∑®ÏÜå
                        </button>
                    </div>
                </div>

                <!-- Î∞∞Ïπò ÌÅ¨Î°≠ -->
                <div id="batchCrop" class="hidden">
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-2">
                            <h3 class="font-bold">Î∞∞Ïπò ÌÅ¨Î°≠</h3>
                            <button onclick="cancelBatch()" class="text-sm text-gray-500">Ï∑®ÏÜå</button>
                        </div>
                        <div id="progressBar" class="hidden">
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                                <div id="progressFill" class="bg-blue-500 h-2 rounded-full transition-all" style="width: 0%"></div>
                            </div>
                            <div class="text-center text-sm text-gray-600">
                                <span id="progressText">0%</span>
                            </div>
                        </div>
                    </div>
                    <button onclick="startBatchCrop()" id="batchButton" 
                            class="w-full py-3 bg-green-500 text-white rounded-lg font-medium active:bg-green-600">
                        ‚úÇÔ∏è ÏùºÍ¥Ñ ÌÅ¨Î°≠ ÏãúÏûë
                    </button>
                </div>
            </div>

            <!-- Ìï©ÏÑ± ÌÉ≠ -->
            <div id="content-compose" class="p-4 hidden">
                <!-- Ìï©ÏÑ± ÏÑ§Ï†ï -->
                <div class="mb-6 space-y-3">
                    <h3 class="font-bold">Ìï©ÏÑ± ÏÑ§Ï†ï</h3>
                    <div>
                        <label class="text-sm text-gray-600">ÏµúÎåÄ ÎÑàÎπÑ (px)</label>
                        <input type="number" id="maxWidth" value="1080" 
                               class="w-full p-2 border rounded-lg mt-1">
                    </div>
                    <div>
                        <label class="text-sm text-gray-600">Ïù¥ÎØ∏ÏßÄ Í∞ÑÍ≤© (px)</label>
                        <input type="number" id="padding" value="10" 
                               class="w-full p-2 border rounded-lg mt-1">
                    </div>
                </div>

                <!-- ÌÅ¨Î°≠Îêú Ïù¥ÎØ∏ÏßÄ Î™©Î°ù -->
                <div class="mb-4">
                    <h3 class="font-bold mb-3">ÌÅ¨Î°≠Îêú Ïù¥ÎØ∏ÏßÄ (<span id="croppedCount">0</span>Í∞ú)</h3>
                    <div id="croppedList" class="space-y-2"></div>
                </div>

                <!-- Ìï©ÏÑ± Î≤ÑÌäº -->
                <button onclick="composeImages()" id="composeButton"
                        class="w-full py-4 bg-purple-500 text-white rounded-lg font-bold text-lg active:bg-purple-600 disabled:bg-gray-300"
                        disabled>
                    üé® Ïù¥ÎØ∏ÏßÄ Ìï©ÏÑ±ÌïòÍ∏∞
                </button>

                <!-- Í≤∞Í≥º ÎØ∏Î¶¨Î≥¥Í∏∞ -->
                <div id="resultPreview" class="mt-6 hidden">
                    <h3 class="font-bold mb-3">Ìï©ÏÑ± Í≤∞Í≥º</h3>
                    <img id="resultImage" class="w-full rounded-lg shadow-lg mb-4">
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="downloadResult()" 
                                class="py-3 bg-green-500 text-white rounded-lg font-medium active:bg-green-600">
                            üíæ Ï†ÄÏû•
                        </button>
                        <button onclick="shareResult()" 
                                class="py-3 bg-blue-500 text-white rounded-lg font-medium active:bg-blue-600">
                            üì§ Í≥µÏú†
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="app.js"></script>
</body>
</html>
